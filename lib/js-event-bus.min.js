"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var EventBus=function(){function EventBus(){_classCallCheck(this,EventBus),_defineProperty(this,"listeners",{})}return _createClass(EventBus,[{key:"on",value:function(eventName,callback){this.registerListener(eventName,callback)}},{key:"once",value:function(eventName,callback){this.registerListener(eventName,callback,1)}},{key:"exactly",value:function(eventName,callback,capacity){this.registerListener(eventName,callback,capacity)}},{key:"die",value:function(eventName){delete this.listeners[eventName]}},{key:"off",value:function(eventName){this.die(eventName)}},{key:"detach",value:function(eventName,callback){var listeners=(listeners=this.listeners[eventName]||[]).filter(function(value){return value.callback!==callback});eventName in this.listeners&&(this.listeners[eventName]=listeners)}},{key:"detachAll",value:function(eventName){this.die(eventName)}},{key:"emit",value:function(eventName,context){for(var _this=this,_len=arguments.length,args=new Array(2<_len?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];var newName,listeners=[];this.hasListeners(eventName)?listeners=this.listeners[eventName]:eventName.includes("*")&&(newName=(newName=eventName.replace(/\*\*/,"([^.]+.?)+")).replace(/\*/g,"[^.]+"),(newName=eventName.match(newName))&&eventName===newName[0]&&(listeners=this.listeners[eventName])),listeners.forEach(function(listener,k){var callback=listener.callback;(callback=context?callback.bind(context):callback).apply(void 0,args),void 0!==listener.triggerCapacity&&(listener.triggerCapacity--,listeners[k].triggerCapacity=listener.triggerCapacity),_this.checkToRemoveListener(listener)&&_this.listeners[eventName].splice(k,1)})}},{key:"registerListener",value:function(eventName,callback,triggerCapacity){this.hasListeners(eventName)||(this.listeners[eventName]=[]),this.listeners[eventName].push({callback:callback,triggerCapacity:triggerCapacity})}},{key:"checkToRemoveListener",value:function(eventInformation){return void 0!==eventInformation.triggerCapacity&&eventInformation.triggerCapacity<=0}},{key:"hasListeners",value:function(eventName){return eventName in this.listeners}}]),EventBus}(),_default=EventBus;exports.default=_default;